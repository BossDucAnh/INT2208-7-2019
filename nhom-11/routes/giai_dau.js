const express = require('express')
const router = express.Router();
var mysql = require('mysql');

var con_anh = mysql.createConnection({
  multipleStatements: true,
  host: "127.0.0.1",
  user: "root",
  password: "",
  database: "clb_anh"
});
con_anh.connect();

router.get('/anh.html', function (req, res) {
  var sql = "SELECT * FROM anh.vong1;SELECT * FROM anh.vong2;SELECT * FROM anh.vong3;SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM arsenal UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM manutd UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM bournemouth UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM brighton UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM burnley UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM cardiff UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM chelsea UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM everton UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM fulham UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM huddersfields UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM leicester UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM liverpool UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM mancity UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM newcastle UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM palace UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM southampton UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM tottenham UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM wolves UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM watford UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM westham ORDER BY `diem`  DESC, hieuso DESC";
  con_anh.query(sql,[1,8], function(err, results) {
    if (err) throw err;
    res.render('Giai_dau/anh', {results});
  });
});

var con_tbn = mysql.createConnection({
  multipleStatements: true,
  host: "127.0.0.1",
  user: "root",
  password: "",
  database: "clb_tbn"
});
con_tbn.connect();
router.get('/taybannha.html', function (req, res) {
  var sql = "SELECT * FROM taybannha.vong1;SELECT * FROM taybannha.vong2;SELECT * FROM taybannha.vong3;SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM alaves UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM atm UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM barcelona UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM betis UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM bilbao UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM celtavigo UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM eibar UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM espanyol UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM getafe UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM girona UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM huesca UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM leganes UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM levante UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM realmadrid UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM sevilla UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM sociedad UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM vallecano UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM valencia UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM valladolid UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM villarreal ORDER BY `diem`  DESC, hieuso DESC";
  con_tbn.query(sql,[1,8], function(err, results) {
    if (err) throw err;
    res.render('Giai_dau/taybannha', {results});
  });
});
var con_duc = mysql.createConnection({
  multipleStatements: true,
  host: "127.0.0.1",
  user: "root",
  password: "",
  database: "clb_duc"
});
con_duc.connect();
router.get('/duc.html', function (req, res) {
  var sql = "SELECT * FROM duc.vong1;SELECT * FROM duc.vong2;SELECT * FROM duc.vong3;SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM augsburg UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM bayernmunich UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM bayerleverkusen UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM dortmund UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM dusseldorf UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM frankfurt UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM freiburg UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM hannover UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM herthaberlin UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM hoffenheim UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM leipzig UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM mainz05 UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM monchengladbach UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM nurnberg UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM stuttgart UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM schalke04 UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM wolfsburg UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM werderbremen ORDER BY `diem`  DESC, hieuso DESC";
  con_duc.query(sql,[1,8], function(err, results) {
    if (err) throw err;
    res.render('Giai_dau/duc', {results});
  });
});
var con_phap = mysql.createConnection({
  multipleStatements: true,
  host: "127.0.0.1",
  user: "root",
  password: "",
  database: "clb_phap"
});
con_phap.connect();
router.get('/phap.html', function (req, res) {
  var sql = "SELECT * FROM phap.vong1;SELECT * FROM phap.vong2;SELECT * FROM phap.vong3;SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM amiens UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM angers UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM bordeaux UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM caen UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM dijon UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM guingamp UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM lille UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM lyon UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM marseille UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM montpellier UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM monaco UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM nantes UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM nice UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM nimes UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM psg UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM rennais UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM reims UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM saintetienne UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM strasbourg UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM toulouse ORDER BY `diem`  DESC, hieuso DESC;SELECT * FROM cauthu_phap.`amiens` UNION SELECT * FROM cauthu_phap.`angers` UNION SELECT * FROM cauthu_phap.`bordeaux` UNION SELECT * FROM cauthu_phap.`caen` UNION SELECT * FROM cauthu_phap.`dijon` UNION SELECT * FROM cauthu_phap.`guingamp` UNION SELECT * FROM cauthu_phap.`lille` UNION SELECT * FROM cauthu_phap.`lyon` UNION  SELECT * FROM cauthu_phap.`marseille` UNION SELECT * FROM cauthu_phap.`monaco` UNION SELECT * FROM cauthu_phap.`montpellier` UNION SELECT * FROM cauthu_phap.`nantes` UNION SELECT * FROM cauthu_phap.`nice` UNION SELECT * FROM cauthu_phap.`nimes` UNION SELECT * FROM cauthu_phap.`psg` UNION SELECT * FROM cauthu_phap.`reims` UNION SELECT * FROM cauthu_phap.`rennais` UNION SELECT * FROM cauthu_phap.`saintetienne` UNION SELECT * FROM cauthu_phap.`strasbourg` UNION SELECT * FROM cauthu_phap.`toulouse`  ORDER BY `banthang` DESC LIMIT 10;SELECT * FROM cauthu_phap.`amiens` UNION SELECT * FROM cauthu_phap.`angers` UNION SELECT * FROM cauthu_phap.`bordeaux` UNION SELECT * FROM cauthu_phap.`caen` UNION SELECT * FROM cauthu_phap.`dijon` UNION SELECT * FROM cauthu_phap.`guingamp` UNION SELECT * FROM cauthu_phap.`lille` UNION SELECT * FROM cauthu_phap.`lyon` UNION  SELECT * FROM cauthu_phap.`marseille` UNION SELECT * FROM cauthu_phap.`monaco` UNION SELECT * FROM cauthu_phap.`montpellier` UNION SELECT * FROM cauthu_phap.`nantes` UNION SELECT * FROM cauthu_phap.`nice` UNION SELECT * FROM cauthu_phap.`nimes` UNION SELECT * FROM cauthu_phap.`psg` UNION SELECT * FROM cauthu_phap.`reims` UNION SELECT * FROM cauthu_phap.`rennais` UNION SELECT * FROM cauthu_phap.`saintetienne` UNION SELECT * FROM cauthu_phap.`strasbourg` UNION SELECT * FROM cauthu_phap.`toulouse`  ORDER BY kientao DESC LIMIT 10;SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`amiens` UNION SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`angers` UNION SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`bordeaux` UNION SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`caen` UNION SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`dijon` UNION SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`guingamp` UNION SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`lille` UNION SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`lyon` UNION  SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`marseille` UNION SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`monaco` UNION SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`montpellier` UNION SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`nantes` UNION SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`nice` UNION SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`nimes` UNION SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`psg` UNION SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`reims` UNION SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`rennais` UNION SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`saintetienne` UNION SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`strasbourg` UNION SELECT SUM(`thevang`) tv, clb FROM cauthu_phap.`toulouse`  ORDER BY tv DESC LIMIT 10;SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`amiens` UNION SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`angers` UNION SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`bordeaux` UNION SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`caen` UNION SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`dijon` UNION SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`guingamp` UNION SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`lille` UNION SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`lyon` UNION  SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`marseille` UNION SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`monaco` UNION SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`montpellier` UNION SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`nantes` UNION SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`nice` UNION SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`nimes` UNION SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`psg` UNION SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`reims` UNION SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`rennais` UNION SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`saintetienne` UNION SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`strasbourg` UNION SELECT SUM(`thedo`) td, clb FROM cauthu_phap.`toulouse`  ORDER BY td DESC LIMIT 10";
  con_phap.query(sql,[1,8], function(err, results) {
    if (err) throw err;
    res.render('Giai_dau/phap', {results});
  });
});
var con_italia = mysql.createConnection({
  multipleStatements: true,
  host: "127.0.0.1",
  user: "root",
  password: "",
  database: "clb_italia"
});
con_italia.connect();
router.get('/italia.html', function (req, res) {
  var sql = "SELECT * FROM italia.vong1;SELECT * FROM italia.vong2;SELECT * FROM italia.vong3;SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM acmilan UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM asroma UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM atalanta UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM bologna UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM cagliari UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM chievo UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM acmilan UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM empoli UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM acmilan UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM fiorentina UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM frosinone UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM genoa UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM acmilan UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM intermilan UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM juventus UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM lazio UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM napoli UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM parma UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM acmilan UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM sampdoria UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM sassuolo UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM spal UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM torino UNION SELECT COUNT(`vong`) st, `logo_doibong` , `doibong`, SUM(IF(`banthang`>`banbai`,1,0)) w , SUM(IF(`banthang`<`banbai`,1,0)) l , SUM(IF(`banthang`=`banbai`,1,0)) d , (SUM(`banthang`)-SUM(`banbai`)) as hieuso , SUM(IF(`banthang`>`banbai`,3,IF(`banthang`<`banbai`,0,1))) as diem  FROM udinese  ORDER BY `diem`  DESC, hieuso DESC";
  con_italia.query(sql,[1,8], function(err, results) {
    if (err) throw err;
    res.render('Giai_dau/italia', {results});
  });
});

module.exports = router;
